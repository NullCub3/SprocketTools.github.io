<html>
  <head>
		<title>Sprocket Tools V0</title>
		<link rel="icon" type="image/x-icon" href="trollsus64.png">
		    <!-- Pyscript -->
		<script defer src="https://pyscript.net/alpha/pyscript.js"></script>
		<!--<link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />-->
		<link rel="stylesheet" href="styles_main.css">
		<!-- bootstrap for styling , Pyscript can also be used for styling instead of bootstrap -->
		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> 
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous" />
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
		
		<style>
		body {
        background-color: dimgray;
        padding-top: 80px;
        min-height: 150px;
        margin:0;
        display:flex;
        flex-direction:column;
		}
		.button.enter:focus {
        outline: none;
		}
    </style> 
  </head>
  <body>
	<py-script>	
	from js import document,alert
	import random
	guncals = [12, 20, 30, 37, 40, 45, 47, 50, 55, 57, 65, 73, 75, 76, 80, 85, 88, 90, 100, 105, 107, 110, 115, 120, 122, 125, 128, 130, 150, 152, 155, 183, 200, 240]
	pyscript.write("loadtext", "Click the button to get your prompt, then build it!")
	pyscript.write("description", "Once you're done, ping Colson  っ(◔◡◔っ) and explain how it went.")
	def update(*ags, **kws):
		# initial declaration
		IsHeavy = 0

		import random
		import time
		random.seed(time.time())
		guncals = [12, 20, 30, 37, 40, 45, 47, 50, 55, 57, 65, 73, 75, 76, 80, 85, 88, 90, 100, 105, 107, 110, 115, 120, 122, 125, 128, 130, 150, 152, 155, 183, 200, 240]
		VehicleName = "error"
		CannonSuffix = ""
		VehGroup = round(100*random.random())
		if VehGroup < 25:
			VehicleName = "Semi-Turreted Tank Destroyer"
			MinWeight = 7
			MaxWeight = 50
			WeightTol = 1
			HeavyWeightAdj = 30
			HeavyChance = 40
			GunCals = [57, 65, 73, 75, 76, 80, 85, 88, 90, 100, 105, 107, 110, 115, 120, 122, 125, 128, 130]
			HowitzerCals = [105, 155, 183, 240]
			HowitzerChance = 25
			MaxGuns = 2
			MultiGunChance = 25
			MinCylCount = 6
			MaxCylCount = 13

		elif VehGroup < 50:
			VehicleName = "Light Tank"
			MinWeight = 10
			MaxWeight = 25
			WeightTol = 1
			HeavyWeightAdj = 0
			HeavyChance = 0
			GunCals = [37, 40, 45, 47, 50, 57, 65, 73, 75, 76, 80, 85, 88, 90]
			HowitzerCals = [105, 155, 183, 240]
			HowitzerChance = 0
			MaxGuns = 2
			MultiGunChance = 12
			MinCylCount = 6
			MaxCylCount = 8
			
		elif VehGroup < 75:
			VehicleName = "Heavy Tank"
			MinWeight = 38
			MaxWeight = 52
			WeightTol = 1
			HeavyWeightAdj = 0
			HeavyChance = 0
			GunCals = [75, 76, 80, 85, 88, 90, 94, 105]
			HowitzerCals = [105, 155, 183, 240]
			HowitzerChance = 38
			MaxGuns = 2
			MultiGunChance = 35
			MinCylCount = 8
			MaxCylCount = 12
			
		elif VehGroup < 95:
			VehicleName = "Medium Tank"
			MinWeight = 12
			MaxWeight = 40
			WeightTol = 1
			HeavyWeightAdj = 0
			HeavyChance = 0
			GunCals = [57, 65, 73, 75, 76, 80, 85, 88, 90]
			HowitzerCals = [105, 152]
			HowitzerChance = 25
			MaxGuns = 2
			MultiGunChance = 25
			MinCylCount = 6
			MaxCylCount = 12
			
		elif VehGroup < 100:
			VehicleName = "Amogus-Piloted Tank"
			MinWeight = 20
			MaxWeight = 40
			WeightTol = 1
			HeavyWeightAdj = 0
			HeavyChance = 0
			GunCals = [37, 40, 45, 47, 50, 55, 57, 65, 73, 75, 76, 80, 85, 88, 90]
			HowitzerCals = [105]
			HowitzerChance = 15
			MaxGuns = 2
			MultiGunChance = 25
			MinCylCount = 8
			MaxCylCount = 12

		#establishing new variables
		Gun = 57
		GunListSize = len(GunCals)
		HowitzerListSize = len(HowitzerCals)
		RNG = random.random()

		#determine if it is a "heavy" variant or not
		if (random.random() < HeavyChance/100.0):
			IsHeavy = 1
			VehicleName = "Heavy " + VehicleName
			print("Build a heavy " + VehicleName + "!")
		else:
			print("Build a " + VehicleName + "!")


		ActWeight = MinWeight + round(random.random()*(MaxWeight -MinWeight)) + HeavyWeightAdj*IsHeavy
		MinWeightVar = ActWeight - WeightTol
		MaxWeightVar = ActWeight + WeightTol
		print("Minimum vehicle weight: " + str(MinWeightVar) + ".0T")
		print("Maximum vehicle weight: " + str(MaxWeightVar) + ".0T")
		rerollRNG()
		if (random.random() < HowitzerChance/100.0):
			Gun = HowitzerCals[round(RNG*HowitzerListSize)-1]
			print("Weapon: " + str(Gun) + "mm howitzer")
			WeaponType = "howitzer"
		else:
			Gun = GunCals[round(RNG*GunListSize)-1]
			print("Weapon: " + str(Gun) + "mm cannon")
			WeaponType = "cannon"

		#next we pick the amount of guns in the vehicle
		rerollRNG()
		GunCount = 1
		i = 2
		while i < 20 and i <= MaxGuns:
			if RNG < (MultiGunChance/((i-1)*100)):
				GunCount = i
			i += 1
			if GunCount > 1:
				CannonSuffix = "s"
		print("Gun count: " + str(GunCount))

		#next we set the engine requirements
		rerollRNG()
		CylCount = MinCylCount + round(RNG*(MaxCylCount - MinCylCount))
		rerollRNG()
		if RNG < 0.5:
    		CylCount = round(CylCount/2)*2
		print("Engine: " + str(CylCount) + " cylinders")

		#now we set the ammo count requirement, based on gun caliber and count
		AmmoMin = round(2000/(Gun+20))
		print("Minimum ammo: " + str(AmmoMin) + " shells")

		#weight adjustment for gun calibers (currently only does one-half of the correct adjustment)
		ActWeight = ActWeight + round(((Gun*0.0115)**3)*GunCount/2)
		ActWeight = ActWeight + round(((CylCount*0.2)**3)/2)
		print(ActWeight)
		
		promptname = "Build a " + VehicleName + "!"
		weight_text = "Your vehicle needs to weigh between " + str(ActWeight - WeightTol) + " and " +  str(ActWeight + WeightTol) + " tons."
		cannon_text = "For weaponry, use " + str(GunCount) + "x " + str(Gun) + "mm " + WeaponType + CannonSuffix + "!"
		engine_text = "Power your vehicle using a " + str(CylCount) + "-cylinder engine!"
		ammo_text = "Lastly, don't forget to have at least " + str(AmmoMin) + " rounds of ammo!"
		
		pyscript.write("promptname", promptname)
		pyscript.write("weight", weight_text)
		pyscript.write("cannon", cannon_text)
		pyscript.write("engine", engine_text)
		pyscript.write("minimum_ammo", ammo_text)	
	def rerollRNG():
    	RNG = random.random()
		   
	</py-script>    
    <div class="container">
        
		<picture>
			<source media="(min-width:1600px)" srcset="YCCP7.png">
			<source media="(min-width:980px)" srcset="YCCP7.png">
			<img src="amongustrollemoji.png" alt="Logo made by retr0_spektro1d in the ICo community!">
		</picture>
		
		<br />
		<h1 class="text-center">
            RNG Testing Utility
        </h1>
        <br />
        <p>
        <center>
			<h4>This is an ongoing test to see how well the RNG is working.</h3>
			<h4 id="loadtext">Loading...</h4>
			<h4 id="description"> </h4>
			<br />
			<div class="button">
            <button id="convert" type="submit" class="enter" pys-onClick="update">Get my Tank!</button>
			</div>
        </center>
        
        <p>
		<h3 id="promptname"> </h3>
		<h4 id="weight"> </h4>
		<h4 id="cannon"> </h4>
		<h4 id="engine"> </h4>
		<h4 id="minimum_ammo"> </h4>
		<h4 id="extra1"> </h4>
		<h4 id="extra2"> </h4>
    
        
    </div>
  </body>
</html>